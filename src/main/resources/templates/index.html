<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Picker Api</title>
</head>
<body>
    <button onclick="pickerDialog()">Pick</button>
</body>
<script type="text/javascript" src="https://apis.google.com/js/api.js"></script>
<script>
    var clientId = '694953642822-0bl51pi5d83vi3cknd05bc0trgtvuii5.apps.googleusercontent.com';
    var key = 'AIzaSyABDZ0-tu7bxwOmY6BZAXsVIvmDTiWhIsg';
    var project_id = '694953642822';

    var scope = 'https://www.googleapis.com/auth/drive.file';

    var oauthToken;
    var pickerApiLoaded = false;
    function pickerDialog() {
        loadPicker();
    }

    function loadPicker() {
        gapi.load('auth', {'callback': onAuthApiLoad})
        gapi.load('picker', {'callback': onPickerApiLoad})
    }

    function onAuthApiLoad() {
        window.gapi.auth.authorize({
            'client_id': clientId,
            'scope': scope,
            'immediate': false
        },
        handleAuthResult
        )
    }

    function onPickerApiLoad() {
        pickerApiLoaded = true;
        createPicker()
    }

    function handleAuthResult(authResult) {
        if(authResult && !authResult.error) {
            oauthToken = authResult.access_token
            createPicker()
        }
    }
    function createPicker() {
        if(pickerApiLoaded && oauthToken) {
            var view = new google.picker.View(google.picker.ViewId.DOCS)
            view.setMimeTypes('image/png, image/jpeg, image/jpg')
            var picker = new google.picker.PickerBuilder()
            .enableFeature(google.picker.Feature.NAV_HIDDEN)
            .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)
            .setAppId(project_id)
            .setOAuthToken(oauthToken)
            .addView(view)
            .addView(new google.picker.DocsUploadView())
            .setDeveloperKey(key)
            .setCallBack(pickerCallback)
            .build()

            picker.setVisible(true)
        }
    }

    function pickerCallback() {}

</script>
</html>